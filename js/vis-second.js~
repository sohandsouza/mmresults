var margin = {top: 20, right: 120, bottom: 20, left: 320},
 twidth = 800 - margin.right - margin.left,
 theight = 500 - margin.top - margin.bottom;
// --> CREATE SVG DRAWING AREA

var tsvg = d3.select("#chart-area").append("svg")
    .attr("width", twidth + margin.right + margin.left)
    .attr("height", theight + margin.top + margin.bottom)
  .append("g")
 .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var tree = d3.layout.tree().size([theight, twidth]);
var diagonal = d3.svg.diagonal()
	.projection(function(d) {
		return [d.y, d.x];
	});



d3.json("data/malaria-parasites.json", function(tdata){
	console.log(tdata);
	var nodes = tree.nodes(tdata[0]).reverse();
	var links = tree.links(nodes);

	nodes.forEach(function(d) { d.y = d.depth * 150; });

	var nodeAll = tsvg.selectAll("g.node")
		.data(nodes, function(d,i) { return d.id || (d.id = ++i); });


	var nodeSet = nodeAll.enter().append("g")
		.attr("transform", function(d) { 
			return "translate(" + d.y + "," + d.x + ")"; }
		);

	nodeSet.append("circle")
		.attr("r", 10)
		.attr("class", "tree-node");

	nodeSet.append("text")
	   .attr("x", function(d) { 
		return d.children || d._children ? -13 : 13; })
	   .attr("dy", function(d,i){ return (d.name.length>20?"-1.45em":"-0.1em");})
	   .attr("dx", "1.45em")
	   .attr("text-anchor", function(d) { 
		return d.children || d._children ? "end" : "start"; })
	   .html(function(d) { return d.name;})
	   .attr("class","tree-label");

	

	var linkSet = tsvg.selectAll("path.link").data(links, function(d) { return d.target.id; })
	linkSet.enter()
		.insert("path","g")
		.attr("class", "tree-link")
		.attr("d", diagonal);
	
});

margin = {top: 50, right: 30, bottom: 100, left: 50};
var bwidth = 660 - margin.left - margin.right
, bheight = 660 - margin.top - margin.bottom;

d3.csv("data/global-funding.csv",function(fdata){
	
});


